<!--TO READ THIS HELP FILE, RIGHT-CLICK ON THE FILE NAME IN THE
    SOLUTION EXPLORER PANE AND SELECT "VIEW IN BROWSER"-->

<html><head><title>ISAPIFilter Sample: Maps URLs to Parameterized Queries</title></head><body><h1>ISAPIFilter Sample: Maps URLs to Parameterized Queries</h1><div id="mainSection"><div id="mainBody"><div id="allHistory" class="saveHistory" onsave="saveAll()" onload="loadAll()"></div><p /><p>Demonstrates the creation of an ISAPI filter using ATL Server's support classes. The filter maps URL requests to new addresses using regular expression replacements provided in a configuration file.</p><p>ATL Server does not provide direct support for ISAPI filters; it only provides support for ISAPI extensions. There are many utility classes provided by ATL and ATL Server that make building a site-enhancing filter easier.</p><p>This sample is a name-mapping filter that translates one URL into another using regular expressions. The mappings are read from a file named friendly.cfg that must be in the same directory as the filter DLL. Each pair of lines is a regular expression to match against followed by a replacement to use if the regular expression is matched. Blank lines are ignored. The regular expressions are checked in the order that they appear in the file.</p><div class="alert"><table width="100%" cellspacing="0" cellpadding="0"><tr><th align="left">Note </th></tr><tr><td><p>The configuration file is loaded once when the filter is first loaded. Subsequent changes to the configuration file will not be apparent in the filter until it is reloaded.</p></td></tr></table></div><p>The configuration file provided with this example includes a single replacement that maps URLs of the form /hello/{\a*} to the following URL: /isapifilter/hello.dll?user=$0. This causes the part of the path following /hello/ to be passed to the request handler DLL in the query string.</p><div class="alert"><table width="100%" cellspacing="0" cellpadding="0"><tr><th align="left">Security Note </th></tr><tr><td><p>This sample code is provided to illustrate a concept and should not be used in applications or Web sites, as it may not illustrate the safest coding practices.</p></td></tr></table></div><h1 class="heading">Building and Running the Sample</h1><div id="sectionSection0" class="seeAlsoNoToggleSection"><h4 class="subHeading">To build and run this sample</h4><div class="subSection"><ol><li><p>Open the solution file, IsapiFilter.sln, in the Visual Studio development environment.</p></li><li><p>Build the solution. This will also deploy the solution to the local Web server.</p></li><li><p>Open Internet Services Manager. Click the <b>Start</b> button, point to <b>Programs</b>, point to <b>Administrative Tools</b>, and click <b>Internet Services Manager</b>.</p></li><li><p>Right-click the active Web site for port 80 (typically <b>Default Web Site</b>) and click <b>Properties</b> from the shortcut menu.</p></li><li><p>Click the <b>ISAPI Filters</b> property page and add \INetpub\wwwroot\ISAPIFilter\friendly.dll to the list of installed filters. Click <b>OK</b> to close the dialog box. </p><div class="alert"><table width="100%" cellspacing="0" cellpadding="0"><tr><th align="left">Note </th></tr><tr><td><p>This adds friendly.dll from the location where it is deployed.</p></td></tr></table></div></li><li><p>Use a Web browser to view http://localhost/hello/<i>YourName</i> (replace <i>YourName</i> with your name). You should see a message greeting you. Observe that your Web site does not have a document or directory that corresponds to the URL you entered, so you can be sure that the filter has redirected the request to the request handler DLL.</p></li></ol></div><sections ><h4 class="subHeading" xmlns="">Demonstrates</h4><div class="subSection" xmlns=""><p><MSHelp:link keywords="93ED160B-AF2A-448C-9CBE-E5FA46C199BB" tabindex="0" >CAtlFile</MSHelp:link> | <MSHelp:link keywords="D2BC9CC1-206F-45CA-824A-18B12122D6E4" tabindex="0" >CAtlFile::Create</MSHelp:link> | <MSHelp:link keywords="8334A5E5-7CD8-4857-90DB-77893C726439" tabindex="0" >CAtlFile::GetSize</MSHelp:link> | <MSHelp:link keywords="1B0E02D1-A5A3-48C4-A590-19F44BA1C0F4" tabindex="0" >CAtlFile::Read</MSHelp:link> | <MSHelp:link keywords="7423717B-B3D5-42A7-AF98-46B0E6356449" tabindex="0" >CAtlRegExp</MSHelp:link> | <MSHelp:link keywords="8B4A9430-42DE-423B-B5B5-B9CFF309FEC1" tabindex="0" >CAtlRegExp::Match</MSHelp:link> | <MSHelp:link keywords="E3EC0F15-7770-41FE-B408-CDDDBC3ACDDA" tabindex="0" >CAtlRegExp::Parse</MSHelp:link> | <MSHelp:link keywords="B04C2CBD-ECC1-4FF3-8451-23FB052DC913" tabindex="0" >CAtlREMatchContext</MSHelp:link> | <MSHelp:link keywords="859CD143-C06A-4FA7-AB5A-49CFB651512C" tabindex="0" >CAtlREMatchContext::GetMatch</MSHelp:link> | <MSHelp:link keywords="8B8B0F47-3526-4F09-B7E9-62C262F61424" tabindex="0" >CAtlREMatchContext::MatchGroup</MSHelp:link> | <MSHelp:link keywords="08988D53-4FB0-4711-BDFC-8AC29C63F410" tabindex="0" >CAutoPtr</MSHelp:link> | <MSHelp:link keywords="35F7E389-5841-43B7-83B8-56A7110D6211" tabindex="0" >CAutoPtr::Attach</MSHelp:link> | <MSHelp:link keywords="880A70DA-8C81-4427-8AC6-49AA8D424244" tabindex="0" >CAutoPtrArray</MSHelp:link> | <MSHelp:link keywords="E5C5BFD4-9BF1-4164-8A83-8155FE253454" tabindex="0" >CHeapPtr</MSHelp:link> | <MSHelp:link keywords="B8AA2F7A-4A97-4A0F-A3EC-148E5BFF663C" tabindex="0" >CHeapPtr::Allocate</MSHelp:link> | <MSHelp:link keywords="80DB7964-9948-406B-AE9D-8CF11CFBBE28" tabindex="0" >CPath</MSHelp:link> | <MSHelp:link keywords="5E3AC7A5-F94B-405F-8EA8-E0AB8EE78E22" tabindex="0" >CPathA</MSHelp:link> | <MSHelp:link keywords="A4A1B669-D465-4261-9964-27CA4D21E9EB" tabindex="0" >CPathT::RemoveFileSpec</MSHelp:link> | <MSHelp:link keywords="6B50FA8F-87E8-4ED4-A229-157CE128710F" tabindex="0" >CStrBufT</MSHelp:link> | <MSHelp:link keywords="7CACC59C-425F-40F1-8F5B-6DB921318EC9" tabindex="0" >CStringT</MSHelp:link> | <MSHelp:link keywords="B5746E07-E4C9-4C9F-A7DA-B3A4AF75F82E" tabindex="0" >CStringT::Find</MSHelp:link></p></div></sections></div></div><div id="footer"><div class="footerLine"></div>
          © Microsoft Corporation. All rights reserved.  Send <a href="mailto:DevDocs@microsoft.com?subject=Documentation Feedback :ISAPIFilter Sample: Maps URLs to Parameterized Queries">comments</a> about this topic to Microsoft.
      </div></div></body></html>
