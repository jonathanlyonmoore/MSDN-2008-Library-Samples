<!--TO READ THIS HELP FILE, RIGHT-CLICK ON THE FILE NAME IN THE
    SOLUTION EXPLORER PANE AND SELECT "VIEW IN BROWSER"-->

<html><head><title>Mailer Sample: Demonstrates SMTP Mail Classes</title></head><body><h1>Mailer Sample: Demonstrates SMTP Mail Classes</h1><div id="mainSection"><div id="mainBody"><div id="allHistory" class="saveHistory" onsave="saveAll()" onload="loadAll()"></div><p /><p>Demonstrates the SMTP mail classes provided with ATL Server.</p><p>The Mailer sample allows you to fill in a form, attach some files, and send the resulting message through SMTP e-mail.</p><div class="alert"><table width="100%" cellspacing="0" cellpadding="0"><tr><th align="left">Security Note </th></tr><tr><td><p>This sample code is provided to illustrate a concept and should not be used in applications or Web sites, as it may not illustrate the safest coding practices.</p></td></tr></table></div><h1 class="heading">Requirements</h1><div id="requirementsSection" class="section"><ul><li><p>IIS</p></li></ul></div><h1 class="heading">Building and Running the Sample</h1><div id="sectionSection0" class="seeAlsoNoToggleSection"><h4 class="subHeading">To build and run this sample</h4><div class="subSection"><ol><li><p>Open the solution file, Mailer.sln, in the Visual Studio development environment.</p></li><li><p>Build the solution. This will also deploy the solution to the local Web server.</p></li><li><p>Use a Web browser to view http://localhost/mailer/mailsamp.htm.</p></li><li><p>Compose your message and click Send Message to send the message. The table below describes the fields that allow you to configure the settings for your message:</p><h3 class="subHeading"></h3><div class="tableSection"><table width="100%" cellspacing="2" cellpadding="5"><tr><th>
                      Field
                    </th><th>
                      Description
                    </th><th>
                      Example
                    </th><th>
                      Optional
                    </th></tr><tr><td><p>Server Name</p></td><td><p>The SMTP server you are sending to.</p></td><td><p>smtp.microsoft.com</p></td><td><p>No</p></td></tr><tr><td><p>Sender Name</p></td><td><p>The friendly name of the sender.</p></td><td><p>John Doe</p></td><td><p>Yes</p></td></tr><tr><td><p>From</p></td><td><p>The sender's e-mail address.</p></td><td><p>johndoe@microsoft.com</p></td><td><p>No</p></td></tr><tr><td><p>Recipient Name</p></td><td><p>The friendly name of the recipient.</p></td><td><p>Jane Doe</p></td><td><p>Yes</p></td></tr><tr><td><p>To</p></td><td><p>The recipient's e-mail address.</p></td><td><p>janedoe@microsoft.com</p></td><td><p>No</p></td></tr><tr><td><p>CC</p></td><td><p>The e-mail address(es) of the recipient(s) to get copies of the message. Multiple addresses should be separated by commas, semicolons, or spaces.</p></td><td><p>ellen@microsoft.com, frank@microsoft.com</p></td><td><p>Yes</p></td></tr><tr><td><p>Subject</p></td><td><p>The subject of the message.</p></td><td><p>Greetings!</p></td><td><p>Yes</p></td></tr><tr><td><p>Message</p></td><td><p>The message body.</p></td><td><p>Hi Jane!</p></td><td><p>Yes</p></td></tr><tr><td><p>Priority</p></td><td><p>The priority of your message.</p></td><td><p>Normal</p></td><td><p>Yes</p></td></tr><tr><td><p>File fields</p></td><td><p>These fields allow you to attach up to 3 files to your message and choose the encoding scheme.</p></td><td><p>file1.txt, file2.txt, file3.txt</p></td><td><p>Yes</p></td></tr></table></div></li></ol></div><sections ><h4 class="subHeading" xmlns="">Demonstrates</h4><div class="subSection" xmlns=""><p><MSHelp:link keywords="295B50BF-D4D4-46CD-A4E7-44F97FC49490" tabindex="0" >CHttpMap::GetNext</MSHelp:link> | <MSHelp:link keywords="384164D2-E2EA-4E19-A0EE-D08F8D7E41E6" tabindex="0" >CHttpMap::GetStartPosition</MSHelp:link> | <MSHelp:link keywords="E6917377-DE38-4F86-A051-4AED2EE07B4E" tabindex="0" >CHttpMap::GetValueAt</MSHelp:link> | <MSHelp:link keywords="4A048CBB-A544-45FB-B5ED-167899D0E91C" tabindex="0" >CHttpRequest::DeleteFiles</MSHelp:link> | <MSHelp:link keywords="AA16297A-BB54-4900-ACD4-0734DE1147A8" tabindex="0" >CMimeHeader::AddCc</MSHelp:link> | <MSHelp:link keywords="622F6D42-BCB6-414D-B7E7-862BE8AD2E46" tabindex="0" >CMimeHeader::AddRecipient</MSHelp:link> | <MSHelp:link keywords="B5C75931-3408-4242-8547-A98417F82817" tabindex="0" >CMimeHeader::SetPriority</MSHelp:link> | <MSHelp:link keywords="BE4B32B3-22CF-4F7C-B353-628CAA85DC5A" tabindex="0" >CMimeHeader::SetSender</MSHelp:link> | <MSHelp:link keywords="0A26EA6E-A1CA-4315-9908-3F2EA2A03FAB" tabindex="0" >CMimeHeader::SetSenderName</MSHelp:link> | <MSHelp:link keywords="01144C4C-96F6-40CB-949A-E8258398E0E6" tabindex="0" >CMimeHeader::SetSubject</MSHelp:link> | <MSHelp:link keywords="C5B886D5-784A-4945-AB7D-941E8368A196" tabindex="0" >CMimeMessage</MSHelp:link> | <MSHelp:link keywords="8D7D1072-6917-48B2-AB88-0622FEAC00EA" tabindex="0" >CMimeMessage::AddText</MSHelp:link> | <MSHelp:link keywords="9529752C-E258-4CB3-B396-D14F68468153" tabindex="0" >CMimeMessage::AttachFile</MSHelp:link> | <MSHelp:link keywords="92F72476-5D58-4E28-80A1-C0FCC233B16F" tabindex="0" >CSMTPConnection</MSHelp:link> | <MSHelp:link keywords="9074255A-A427-4163-8812-EFBFE685BB38" tabindex="0" >CSMTPConnection::Connect</MSHelp:link> | <MSHelp:link keywords="40E54DA3-71A2-4ABB-8485-FB151EA31464" tabindex="0" >CSMTPConnection::SendMessage</MSHelp:link> | <MSHelp:link keywords="D793C8E1-3FCC-4450-ABB9-DC960421F9D6" tabindex="0" >CValidateContext</MSHelp:link> | <MSHelp:link keywords="426FAE53-97C1-4D13-9E92-08B5E1B4F068" tabindex="0" >CValidateContext::GetResultAt</MSHelp:link> | <MSHelp:link keywords="7F031813-8CE3-4246-8288-87C45C81FB31" tabindex="0" >CValidateContext::GetResultCount</MSHelp:link> | <MSHelp:link keywords="479F369D-8DA4-4FAC-9BD0-EC9A20988001" tabindex="0" >CValidateContext::ParamsOK</MSHelp:link> | <MSHelp:link keywords="8C800871-5C35-4934-B6DD-4AEC1DD233C0" tabindex="0" >CWriteStreamHelper::Write</MSHelp:link> | <MSHelp:link keywords="7FB02248-A745-40D2-8E30-F9F91034E83A" tabindex="0" >IHttpFile::GetFileName</MSHelp:link> | <MSHelp:link keywords="34EE444A-9E99-4379-B026-34241B29BCB0" tabindex="0" >IHttpFile::GetTempFileName</MSHelp:link></p></div></sections></div></div><div id="footer"><div class="footerLine"></div>
          © Microsoft Corporation. All rights reserved.  Send <a href="mailto:DevDocs@microsoft.com?subject=Documentation Feedback :Mailer Sample: Demonstrates SMTP Mail Classes">comments</a> about this topic to Microsoft.
      </div></div></body></html>
