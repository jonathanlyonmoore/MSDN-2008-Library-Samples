<!--TO READ THIS HELP FILE, RIGHT-CLICK ON THE FILE NAME IN THE
    SOLUTION EXPLORER PANE AND SELECT "VIEW IN BROWSER"-->

<html><head><title>OnlineAddressBook Sample: Stores an Address Book in an XML Web Service</title></head><body><h1>OnlineAddressBook Sample: Stores an Address Book in an XML Web Service</h1><div id="mainSection"><div id="mainBody"><div id="allHistory" class="saveHistory" onsave="saveAll()" onload="loadAll()"></div><p /><p>Demonstrates the use of session state to store an address book in an XML Web service created with ATL Server.</p><p>The OnlineAddressBook sample uses OLE DB client template classes to store a user's address book and lets the user set and retrieve this information using an XML Web service created with ATL Server. </p><div class="alert"><table width="100%" cellspacing="0" cellpadding="0"><tr><th align="left">Security Note </th></tr><tr><td><p>This sample code is provided to illustrate a concept and should not be used in applications or Web sites, as it may not illustrate the safest coding practices.</p></td></tr></table></div><h1 class="heading">Requirements</h1><div id="requirementsSection" class="section"><ul><li><p>IIS</p></li><li><p>Microsoft Office XP</p></li></ul></div><h1 class="heading">Building and Running the Sample</h1><div id="sectionSection0" class="seeAlsoNoToggleSection"><div class="alert"><table width="100%" cellspacing="0" cellpadding="0"><tr><th align="left">Note </th></tr><tr><td><p>This sample requires Microsoft Office XP.</p></td></tr></table></div><h4 class="subHeading">To build and run this sample</h4><div class="subSection"><ol><li><p>Open the solution file, OnlineAddressBook.sln, in the Visual Studio development environment.</p></li><li><p>Modify the OnlineAddressBookWS.disco file and the deployment project target computer name to point to the computer you are planning to deploy to. Alternately, you can run all of the projects without any modifications if you deploy and run everything to localhost.</p></li><li><p>Copy the included Microsoft Access database, OnlineAddressBookWS.mdb, to your C:\ drive. Alternatively, you can copy it to a different location as long as you modify <code>MYDATASOURCE</code>, which is defined in the file OnlineAddressBookWS\OnlineAddressBookWS.h.</p></li><li><p>Build OnlineAddressBookWSIsapi and OnlineAddressBookWS. This step will also create a virtual directory on your computer and deploy the relevant files there.</p></li><li><p>Build the included C# project, OnlineAddressBookCSharpClient. Set it as a startup project and run it so that you can use this client to import your current personal address book from Microsoft Outlook XP and upload it to your server or any server running this XML Web service. You can also create your own contacts and upload them to the XML Web service and later download them from anywhere.</p></li><li><p>Build OnlineAddressBookSRF. This will deploy an ATL Server project with a built-in XML Web service client. Once you have created an account and added some records to your address book with it using the C# client, you can use this project to view your contacts using a browser. This page should be in http://localhost/OnlineAddressBookWS/OnlineAddressBookSRF.srf.</p></li></ol></div><sections ><h4 class="subHeading" xmlns="">Demonstrates</h4><div class="subSection" xmlns=""><p><MSHelp:link keywords="9EAE7F96-C335-452D-B0E7-DCC57D6332DE" tabindex="0" >ISession::SetVariable</MSHelp:link> | <MSHelp:link keywords="3935993E-9662-43BA-91C6-B531C9EDA30B" tabindex="0" >ISession::GetVariable</MSHelp:link> | <MSHelp:link keywords="E67ACBD2-9632-4E07-87FA-F8B62FF86763" tabindex="0" >ISessionStateService::CloseSession</MSHelp:link> | <MSHelp:link keywords="F90C4C95-4630-438D-8EA9-C5C9BE8DFFEE" tabindex="0" >ISessionStateService::CreateNewSession</MSHelp:link> | <MSHelp:link keywords="9B88193E-EFEB-4DD8-9785-59972CEDA232" tabindex="0" >ISessionStateService::GetSession</MSHelp:link> | <MSHelp:link keywords="F5DE9124-EB3C-4B78-B97A-F4F7BCD86C3B" tabindex="0" >CAccessorRowset::Close</MSHelp:link> | <MSHelp:link keywords="36529B14-6500-4545-B96E-2EA76C349107" tabindex="0" >GetDataSource</MSHelp:link> | <MSHelp:link keywords="FBFECF70-0209-40FE-AB50-013C050EBFA1" tabindex="0" >ISession</MSHelp:link> | <MSHelp:link keywords="8F35048B-7958-4D6E-9175-EFE41F33C4F8" tabindex="0" >ISessionStateService</MSHelp:link> | <MSHelp:link keywords="628C13B9-4F3E-42F7-86E5-4114BE6426E8" tabindex="0" >IDataSourceCache</MSHelp:link> | <MSHelp:link keywords="27E0776C-EE10-4D58-860A-9A37BB3D7F30" tabindex="0" >soap_method</MSHelp:link> | <MSHelp:link keywords="57D7F506-B69C-4A4B-A03A-5CB8CA77FAD2" tabindex="0" >soap_handler</MSHelp:link> | <MSHelp:link keywords="714C3E15-85D7-408B-9A7C-88505C3E5D24" tabindex="0" >db_command</MSHelp:link></p></div></sections></div></div><div id="footer"><div class="footerLine"></div>
          © Microsoft Corporation. All rights reserved.  Send <a href="mailto:DevDocs@microsoft.com?subject=Documentation Feedback :OnlineAddressBook Sample: Stores an Address Book in an XML Web Service">comments</a> about this topic to Microsoft.
      </div></div></body></html>
