<!--TO READ THIS HELP FILE, RIGHT-CLICK ON THE FILE NAME IN THE
    SOLUTION EXPLORER PANE AND SELECT "VIEW IN BROWSER"-->

<html><head><title>SecureSOAP Sample: Implements a Secure SOAP Communication (HTTPS)</title></head><body><h1>SecureSOAP Sample: Implements a Secure SOAP Communication (HTTPS)</h1><div id="mainSection"><div id="mainBody"><div id="allHistory" class="saveHistory" onsave="saveAll()" onload="loadAll()"></div><p /><p>Demonstrates how to implement a secure SOAP communication.</p><p>The SecureSOAP sample shows how to implement a secure SOAP communication using the following:  </p><ul><li><p>A custom SSL-enabled socket class as a template parameter for <b>CSoapSocketClientT</b>, based on the security support provided by Windows 2000</p></li><li><p>The MSXML HTTP client (<b>CSoapMSXMLInetClient</b>)</p></li><li><p>The WinInet-based HTTP client (<b>CSoapWininetClient</b>)</p></li></ul><div class="alert"><table width="100%" cellspacing="0" cellpadding="0"><tr><th align="left">Security Note </th></tr><tr><td><p>This sample code is provided to illustrate a concept and should not be used in applications or Web sites, as it may not illustrate the safest coding practices.</p></td></tr></table></div><h1 class="heading">Requirements</h1><div id="requirementsSection" class="section"><ul><li><p>IIS</p></li><li><p>SSL Certificate</p></li><li><p>Windows 2000 or later</p></li></ul></div><h1 class="heading">Building and Running the Sample</h1><div id="sectionSection0" class="seeAlsoNoToggleSection"><h4 class="subHeading">To build the sample</h4><div class="subSection"><ol><li><p>Open the solution file, SecureSOAP.sln, in the Visual Studio development environment.</p></li><li><p>At line 57 in SecureValidationClient.cpp, replace <code>&lt;your_machine_name&gt;</code> with the name of your Web server and remove the <code>#pragma message</code> directive at the line above.</p></li><li><p>Build the solution. This will build SecureValidation.dll, which is a combined DLL implementing the ISAPI interface, a request handler, and a SOAP handler (XML Web service).</p></li><li><p>Deploy the solution manually: </p><ol><li><p>Create a virtual folder within IIS.</p></li><li><p>Map a directory to this virtual folder.</p></li><li><p>Copy SecureValidation.dll and SecureValidation.srf to that directory.</p></li><li><p>Configure the "dll" and "srf" extensions to be associated with the SecureValidation.dll ISAPI extension DLL.</p></li></ol></li></ol></div><h4 class="subHeading">To set up SSL on your Web server</h4><div class="subSection"><ol><li><p>If you have IIS 5, see http://localhost/iisHelp/iis/misc/default.asp and navigate in the Contents window to Administration-&gt;Server Administration-&gt;Security-&gt;Certificates-&gt;Setting Up SSL on Your Server.</p></li><li><p>See certReadme.txt in the SecureSOAP sample folder. This file contains a step-by-step tutorial on how to generate and install digital certificates.</p></li></ol></div><h4 class="subHeading">To run the sample</h4><div class="subSection"><ol><li><p>Run SecureValidationClient.exe.</p></li><li><p>To check the Web page, use the following URL: </p><div class="code"><span codeLanguage="other"><table width="100%" cellspacing="0" cellpadding="0"><tr><td colspan="2"><pre>https://&lt;your_web_server&gt;/&lt;your_virtual_path&gt;/SecureValidation.srf</pre></td></tr></table></span></div><p>The Web page will display output showing whether communication succeeded or failed. </p></li></ol></div><sections ><h4 class="subHeading" xmlns="">Demonstrates</h4><div class="subSection" xmlns=""><p><MSHelp:link keywords="EF6533D5-4DB4-42A2-B48C-BA07423CF6DF" tabindex="0" >CSoapSocketClientT</MSHelp:link> | <MSHelp:link keywords="4664707C-4FFC-4F11-B668-4EFA4B47C782" tabindex="0" >CSoapMSXMLInetClient</MSHelp:link> | <MSHelp:link keywords="F5E33710-94DE-48A0-9EC3-66040B350502" tabindex="0" >CSOAPWininetClient</MSHelp:link> | <MSHelp:link keywords="9F03A68B-6DCA-481E-889D-E10E9016B001" tabindex="0" >CSoapRootHandler::Cleanup</MSHelp:link> | <MSHelp:link keywords="46D675BB-C236-4B3E-AD78-0D8F1E2CD1FD" tabindex="0" >CSoapSocketClientT::SetUrl</MSHelp:link></p></div></sections></div></div><div id="footer"><div class="footerLine"></div>
          © Microsoft Corporation. All rights reserved.  Send <a href="mailto:DevDocs@microsoft.com?subject=Documentation Feedback :SecureSOAP Sample: Implements a Secure SOAP Communication (HTTPS)">comments</a> about this topic to Microsoft.
      </div></div></body></html>
