<!--TO READ THIS HELP FILE, RIGHT-CLICK ON THE FILE NAME IN THE
    SOLUTION EXPLORER PANE AND SELECT "VIEW IN BROWSER"-->

<html><head><title>MantaWeb Sample: Online Personal Information Management</title></head><body><h1>MantaWeb Sample: Online Personal Information Management</h1><div id="mainSection"><div id="mainBody"><div id="allHistory" class="saveHistory" onsave="saveAll()" onload="loadAll()"></div><p /><p>Demonstrates how to use ATL Server to build a personal information management Web site that includes e-mail, scheduling and task lists, and a file store.</p><p>The MantaWeb sample includes the following features:  </p><ul><li><p>Use of attributed and nonattributed programming for easy comparison</p></li><li><p>Use of persistent and session cookies</p></li><li><p>Heavy use of stenciled pages to separate dynamic and static content</p></li><li><p>Use of ATL Server validation and exchange support</p></li><li><p>Use of SMTP classes for e-mail support</p></li><li><p>Mail XML Web service with native client for stand-alone e-mail access</p></li></ul><div class="alert"><table width="100%" cellspacing="0" cellpadding="0"><tr><th align="left">Note </th></tr><tr><td><p>Because JET components are not supported on the 64-bit versions of Microsoft Windows, this sample only works with the 32-bit versions.</p></td></tr></table></div><div class="alert"><table width="100%" cellspacing="0" cellpadding="0"><tr><th align="left">Security Note </th></tr><tr><td><p>This sample code is provided to illustrate a concept and should not be used in applications or Web sites, as it may not illustrate the safest coding practices.</p></td></tr></table></div><h1 class="heading">Requirements</h1><div id="requirementsSection" class="section"><ul><li><p>IIS</p><div class="alert"><table width="100%" cellspacing="0" cellpadding="0"><tr><th align="left">Note </th></tr><tr><td><p>On Windows Server 2003, your machine must be configured as an Application Server.</p></td></tr></table></div></li></ul></div><h1 class="heading">Building and Running the Sample</h1><div id="sectionSection0" class="seeAlsoNoToggleSection"><h4 class="subHeading">To build the sample and set up the Web site</h4><div class="subSection"><ol><li><p>Create the following folders on your machine. </p><div class="code"><span codeLanguage="other"><table width="100%" cellspacing="0" cellpadding="0"><tr><td colspan="2"><pre>C:\MantaWebSample
C:\MantaWebSample\Database
C:\MantaWebSample\FileStore</pre></td></tr></table></span></div><p>Note that if you do not use the suggested paths, you will have to change the hardcoded strings in \Common\MWS_Common.h and \FileStore\FilesHandler.h. </p></li><li><p>Set permission for the IUSR_<i>machinename</i> user for C:\MantaWebSample\Database and C:\MantaWebSample\FileStore to allow read and write operations. </p><p>To do this, right-click the MantaWebSample folder and click <b>Properties</b>. The <b>Properties</b> dialog box appears. Click the <b>Security </b>tab, and then click <b>Add</b>. In the <b>Select Users, Computers, or Groups</b> dialog box, ensure that <b>Object Types</b> includes <b>Users</b>, click <b>Locations </b>and select the local machine, and then enter IUSR_<i>machinename</i> in <b>Enter the object names to select</b> box. Click <b>Check Names</b>. An entry for <b>Internet Guest Account</b> will appear in the <b>Properties</b> dialog box; in the lower pane, select <b>Read</b> and <b>Write</b>. Click <b>OK</b>. This sets the permissions to allow read and write access for the folder and both subfolders. </p></li><li><p>Copy manta\MantaWeb\MantaWeb.mdb to the C:\MantaWebSample\Database directory. Ensure that the database file is not read-only.</p></li><li><p>Open the solution file, MantaWeb.sln, in the Visual Studio integrated development environment.</p></li><li><p>Build the solution. This will also deploy the solution to the local Web server.</p></li><li><p>Use the Internet Information Services Manager to add login.srf as a default document for the MantaWeb virtual directory. Right-click <b>My Computer</b>. On the shortcut menu, click <b>Manage</b>. In the <b>Computer Management</b> dialog box, open <b>Internet Information Services</b>, then <b>Web Sites</b>, and then <b>Default Web Site</b>.</p></li><li><p>Use Internet Explorer to view http://localhost/mantaweb/. </p><p>If you change the virtual directory that the MantaWeb solution deploys to, you will need to take the following steps to update the MFC mail client:  </p><ol><li><p>Open the mailservice.h file in the MailClientMFC project.</p></li><li><p>On line 75, change the string passed to the <b>TClient</b> base constructor to reflect the changes made to the path on the Web server.</p></li><li><p>Build the MailClientMFC project.</p></li></ol></li></ol></div><h4 class="subHeading">To use the Web site</h4><div class="subSection"><ol><li><p>Use a Web browser to view http://localhost/mantaweb/login.srf.</p></li><li><p>Sign up for an account. Provide values for all requested information.</p></li><li><p>Log in to the site.</p></li><li><p>Use the site to send mail and manage your personal information.</p></li></ol></div></div><h1 class="heading">Notes</h1><div id="sectionSection1" class="seeAlsoNoToggleSection"><p>By default, the MantaWeb sample will not send mail through the localhost SMTP server unless the following preprocessor defines are set: <b>SEND_CONFIRMATION_MAIL</b>, <b>SEND_FORGOTPASS_MAIL</b>, and <b>SEND_OUTGOING_MAIL</b>. You can uncomment the preprocessor <b>#define</b>s in \Common\MWS_Common.h.</p><p>This sample was written so that developers can learn about ATL Server without having to have SQL Server installed. It is strongly recommended that you use SQL Server for your Web-based applications because of its enhanced security features. It is also strongly recommended that you use SQL Server stored procedures wherever possible for your database logic.</p></div><h1 class="heading">Project Layout</h1><div id="sectionSection2" class="seeAlsoNoToggleSection"><p>The project layout of MantaWeb is as follows:</p><h3 class="subHeading"></h3><div class="tableSection"><table width="100%" cellspacing="2" cellpadding="5"><tr><th>
              Folder
            </th><th>
              Description
            </th></tr><tr><td><p>Calendar</p></td><td><p>Nonattributed ATL Server application DLL project that provides a task list and basic calendar and scheduling support.</p></td></tr><tr><td><p>Common</p></td><td><p>Folder holding header files used by all application DLL projects.</p></td></tr><tr><td><p>FileStore</p></td><td><p>Nonattributed ATL Server application DLL project that provides an online file management system.</p></td></tr><tr><td><p>Login</p></td><td><p>Attributed ATL Server application DLL project that provides for user signup and login.</p></td></tr><tr><td><p>Mailbox</p></td><td><p>Attributed ATL Server application DLL project that provides the mailbox functionality to the Web site.</p></td></tr><tr><td><p>MailClientMFC</p></td><td><p>XML Web service MFC client that uses the MantaWeb's XML Web service to check e-mail.</p></td></tr><tr><td><p>MailService</p></td><td><p>Attributed ATL Server application DLL project that provides the mail XML Web service and discovery of the XML Web service.</p></td></tr><tr><td><p>Main</p></td><td><p>Attributed ATL Server application DLL project that provides session checking and profile management.</p></td></tr><tr><td><p>MantaWeb</p></td><td><p>Nonattributed ATL Server ISAPI DLL project.</p></td></tr><tr><td><p>MantaWeb\Images</p></td><td><p>Folder holding all images used on the Web site.</p></td></tr></table></div><sections ><h4 class="subHeading" xmlns="">Demonstrates</h4><div class="subSection" xmlns=""><p><MSHelp:link keywords="EE7D765A-30A0-4E0E-A44B-D95A3A62CD61" tabindex="0" >BEGIN_HANDLER_MAP</MSHelp:link> | <MSHelp:link keywords="3D46B1AD-A17F-4E44-B114-A1938BE356EB" tabindex="0" >BEGIN_REPLACEMENT_METHOD_MAP</MSHelp:link> | <MSHelp:link keywords="F5DE9124-EB3C-4B78-B97A-F4F7BCD86C3B" tabindex="0" >CAccessorRowset::Close</MSHelp:link> | <MSHelp:link keywords="D2BC9CC1-206F-45CA-824A-18B12122D6E4" tabindex="0" >CAtlFile::Create</MSHelp:link> | <MSHelp:link keywords="1B0E02D1-A5A3-48C4-A590-19F44BA1C0F4" tabindex="0" >CAtlFile::Read</MSHelp:link> | <MSHelp:link keywords="20F37524-4A95-4D69-AFA3-9C24B36532C5" tabindex="0" >CCookie::AddValue</MSHelp:link> | <MSHelp:link keywords="11FEB877-7797-49F8-B4EE-52F25348CD91" tabindex="0" >CCookie::SetDiscard</MSHelp:link> | <MSHelp:link keywords="291368B6-DB0A-4A26-B7BB-E00513E8A32E" tabindex="0" >CCookie::SetExpires</MSHelp:link> | <MSHelp:link keywords="5AD9D4C9-21BD-4F80-88AA-58C0A8C7FC35" tabindex="0" >CCookie::SetName</MSHelp:link> | <MSHelp:link keywords="795360B6-AC03-49A0-8F91-BD0EF173BD30" tabindex="0" >CCookie::SetPath</MSHelp:link> | <MSHelp:link keywords="A61A3255-6C1E-4FF8-AE4A-A67C91C345DE" tabindex="0" >CCryptHash::AddData</MSHelp:link> | <MSHelp:link keywords="04475A6E-F749-4AFB-80B8-BAFCD0A0D087" tabindex="0" >CCryptHash::GetSize</MSHelp:link> | <MSHelp:link keywords="0141ECC6-28DF-41B9-8241-83C5BFF6BD3B" tabindex="0" >CCryptHash::GetValue</MSHelp:link> | <MSHelp:link keywords="33A8D894-AD63-44CD-8FF7-B8D0D9E34170" tabindex="0" >CCryptProv::GenRandom</MSHelp:link> | <MSHelp:link keywords="D320BF4B-61D7-416F-803A-0D5ECA0DD473" tabindex="0" >CCryptProv::Initialize</MSHelp:link> | <MSHelp:link keywords="77432D85-4E20-49EC-A0B0-142137828471" tabindex="0" >CDataConnection</MSHelp:link> | <MSHelp:link keywords="5842D3B6-CA3F-4CA4-A89B-C0B2837487E9" tabindex="0" >CHttpRequest::Cookies</MSHelp:link> | <MSHelp:link keywords="D604328C-F20F-49CC-A49F-EEE4AB4160B1" tabindex="0" >CHttpRequest::GetFirstFile</MSHelp:link> | <MSHelp:link keywords="9F458D98-0BF1-4322-B5A0-7DBFCE55DE7C" tabindex="0" >CHttpRequest::GetFirstFormVar</MSHelp:link> | <MSHelp:link keywords="D0CA936D-73EC-45D1-BF29-F3E462A01907" tabindex="0" >CHttpRequest::GetFormVars</MSHelp:link> | <MSHelp:link keywords="E4FD45EF-25C5-4BCF-877F-9BBEFAF0F2F8" tabindex="0" >CHttpRequest::GetNextFile</MSHelp:link> | <MSHelp:link keywords="2C0575EF-A732-4CF7-8A75-30973A895D2E" tabindex="0" >CHttpRequest::GetNextFormVar</MSHelp:link> | <MSHelp:link keywords="AF9C8C3B-E664-4A19-B5DC-47AA19736059" tabindex="0" >CHttpRequest::GetQueryParams</MSHelp:link> | <MSHelp:link keywords="57A012C7-58E7-4E2E-AE21-D1E33B28D109" tabindex="0" >CHttpRequest::GetServerContext</MSHelp:link> | <MSHelp:link keywords="DA804EED-D95B-4FEB-B6F1-1A87D814FD98" tabindex="0" >CHttpRequestParams::Lookup</MSHelp:link> | <MSHelp:link keywords="89B41B15-6D4E-4963-804E-D8062F45EF8D" tabindex="0" >CHttpResponse::AppendCookie</MSHelp:link> | <MSHelp:link keywords="6E8E0C90-38A4-4CC9-91AE-4C2971CBA194" tabindex="0" >CHttpResponse::AppendHeader</MSHelp:link> | <MSHelp:link keywords="D264E0B5-4EBF-4E10-8014-7FC0BB32A61C" tabindex="0" >CHttpResponse::ClearResponse</MSHelp:link> | <MSHelp:link keywords="F9ECA4A7-08EC-4496-8940-42A49946DC91" tabindex="0" >CHttpResponse::Flush</MSHelp:link> | <MSHelp:link keywords="B6F2FB2D-790F-4132-B962-04BC3935B57E" tabindex="0" >CHttpResponse::Redirect</MSHelp:link> | <MSHelp:link keywords="21DEB3BA-E329-4301-B871-0398F8842FA9" tabindex="0" >CHttpResponse::SendHeadersInternal</MSHelp:link> | <MSHelp:link keywords="86813026-2C11-47C9-B6CA-748E2394716C" tabindex="0" >CHttpResponse::SetContentType</MSHelp:link> | <MSHelp:link keywords="CF629CFB-BEFE-4045-9AA3-4AB771D92BD1" tabindex="0" >CIsapiExtension::GetExtensionVersion</MSHelp:link> | <MSHelp:link keywords="A3F871B8-B028-4A08-B4FE-28A3418349FC" tabindex="0" >CIsapiExtension::TerminateExtension</MSHelp:link> | <MSHelp:link keywords="8F6EBB06-E180-4FD9-970C-49FD9533B18E" tabindex="0" >CIsapiWorker::GetWorkerData</MSHelp:link> | <MSHelp:link keywords="622F6D42-BCB6-414D-B7E7-862BE8AD2E46" tabindex="0" >CMimeHeader::AddRecipient</MSHelp:link> | <MSHelp:link keywords="BE4B32B3-22CF-4F7C-B353-628CAA85DC5A" tabindex="0" >CMimeHeader::SetSender</MSHelp:link> | <MSHelp:link keywords="0A26EA6E-A1CA-4315-9908-3F2EA2A03FAB" tabindex="0" >CMimeHeader::SetSenderName</MSHelp:link> | <MSHelp:link keywords="01144C4C-96F6-40CB-949A-E8258398E0E6" tabindex="0" >CMimeHeader::SetSubject</MSHelp:link> | <MSHelp:link keywords="8D7D1072-6917-48B2-AB88-0622FEAC00EA" tabindex="0" >CMimeMessage::AddText</MSHelp:link> | <MSHelp:link keywords="37937393-B9B1-4DAF-836A-ACF126B4B831" tabindex="0" >COleDateTime::GetCurrentTime</MSHelp:link> | <MSHelp:link keywords="7441EADC-FCEA-4D8D-827D-8953728559FC" tabindex="0" >COleDateTime::GetDay</MSHelp:link> | <MSHelp:link keywords="ABF60E54-79F4-48A1-82B9-F92ACE8903EC" tabindex="0" >COleDateTime::GetDayOfWeek</MSHelp:link> | <MSHelp:link keywords="D6D303A5-5F61-4EE5-A6BD-9CF012399C3A" tabindex="0" >COleDateTime::GetHour</MSHelp:link> | <MSHelp:link keywords="26370967-45B4-4BBD-9CB6-09909510C00B" tabindex="0" >COleDateTime::GetMinute</MSHelp:link> | <MSHelp:link keywords="9A41A1E8-9E90-43AF-9D54-DD0BA60EFB47" tabindex="0" >COleDateTime::GetMonth</MSHelp:link> | <MSHelp:link keywords="B9047549-C616-4CBC-9709-8B3DDD6B19D7" tabindex="0" >COleDateTime::GetStatus</MSHelp:link> | <MSHelp:link keywords="F2009137-1673-4FB9-862E-BD9EB88E9224" tabindex="0" >COleDateTime::GetYear</MSHelp:link> | <MSHelp:link keywords="734AB792-5F5C-47D5-82A0-2396C0F8255C" tabindex="0" >COleDateTime::ParseDateTime</MSHelp:link> | <MSHelp:link keywords="76E8466B-897A-4144-A545-4CCDC1BB035D" tabindex="0" >COleDateTime::SetDate</MSHelp:link> | <MSHelp:link keywords="0BC272BB-D37D-4E19-94EB-35DFF49B1829" tabindex="0" >COleDateTime::SetStatus</MSHelp:link> | <MSHelp:link keywords="7441526D-A30A-4019-8FB3-3FEE6F897CBE" tabindex="0" >COleDateTimeSpan</MSHelp:link> | <MSHelp:link keywords="DDC3D412-BCF7-4551-B8A3-412F04EED04F" tabindex="0" >CRequestHandlerT</MSHelp:link> | <MSHelp:link keywords="5F981D0D-CF35-490F-9EC0-8B2E365CF398" tabindex="0" >CRequestHandlerT::m_HttpRequest</MSHelp:link> | <MSHelp:link keywords="9B0CC0B0-38D2-4EB4-85D8-7F88087796A5" tabindex="0" >CRequestHandlerT::m_HttpResponse</MSHelp:link> | <MSHelp:link keywords="2BB23AC7-0C75-4B66-A10C-1ECFBBE45620" tabindex="0" >CRequestHandlerT::ValidateAndExchange</MSHelp:link> | <MSHelp:link keywords="9074255A-A427-4163-8812-EFBFE685BB38" tabindex="0" >CSMTPConnection::Connect</MSHelp:link> | <MSHelp:link keywords="40E54DA3-71A2-4ABB-8485-FB151EA31464" tabindex="0" >CSMTPConnection::SendMessage</MSHelp:link> | <MSHelp:link keywords="6FA4EA8F-9957-4AA6-B242-5ABFA524C0A9" tabindex="0" >CStringT::Format</MSHelp:link> | <MSHelp:link keywords="D3E726B2-F6E8-48BA-AAC7-F198DEAB8ABE" tabindex="0" >CValidateObject::Exchange</MSHelp:link> | <MSHelp:link keywords="877B56AA-2AB4-4B52-92A9-04D9B2AE6B3A" tabindex="0" >CValidateObject::Validate</MSHelp:link> | <MSHelp:link keywords="5339C3F2-CE6D-42C6-A043-691580EDB5DF" tabindex="0" >CWriteStreamHelper::operator &lt;&lt;</MSHelp:link> | <MSHelp:link keywords="58DA4AFC-F69C-4AE6-AF9A-3F9515F56081" tabindex="0" >db_column</MSHelp:link> | <MSHelp:link keywords="714C3E15-85D7-408B-9A7C-88505C3E5D24" tabindex="0" >db_command</MSHelp:link> | <MSHelp:link keywords="A28315F5-4722-459E-92EF-32E83C0B205A" tabindex="0" >db_param</MSHelp:link> | <MSHelp:link keywords="204A008D-CDBA-471A-B1E9-A70165FB12D6" tabindex="0" >EscapeToCString</MSHelp:link> | <MSHelp:link keywords="70B3E848-FAD6-4E09-8C72-BE60CA72A4DF" tabindex="0" >export</MSHelp:link> | <MSHelp:link keywords="36529B14-6500-4545-B96E-2EA76C349107" tabindex="0" >GetDataSource</MSHelp:link> | <MSHelp:link keywords="AAC6712C-9382-4169-997C-62CBCC16F535" tabindex="0" >HANDLER_ENTRY</MSHelp:link> | <MSHelp:link keywords="047A890D-E14E-4573-A854-829819FCC881" tabindex="0" >HTTP_CODE</MSHelp:link> | <MSHelp:link keywords="1D682E42-87FB-40A2-AD0C-DFD0169989C3" tabindex="0" >IHttpServerContext::WriteClient</MSHelp:link> | <MSHelp:link keywords="A688F391-9646-4638-BEA5-CFC4AF6FCD79" tabindex="0" >IRequestHandlerImpl::m_spServiceProvider</MSHelp:link> | <MSHelp:link keywords="9A63F5B5-8E7B-461A-91B8-745E9023E708" tabindex="0" >REPLACEMENT_METHOD_ENTRY</MSHelp:link> | <MSHelp:link keywords="EB838743-0862-4DC1-BBC7-F5A5495190CE" tabindex="0" >REPLACEMENT_METHOD_ENTRY_EX</MSHelp:link> | <MSHelp:link keywords="93C8A7F0-C0D5-42A0-BB6F-02C25054E272" tabindex="0" >request_handler</MSHelp:link> | <MSHelp:link keywords="57D7F506-B69C-4A4B-A03A-5CB8CA77FAD2" tabindex="0" >soap_handler</MSHelp:link> | <MSHelp:link keywords="27E0776C-EE10-4D58-860A-9A37BB3D7F30" tabindex="0" >soap_method</MSHelp:link> | <MSHelp:link keywords="22300601-E0AC-46DA-A117-F490E2DBF5EA" tabindex="0" >tag_name</MSHelp:link></p></div></sections></div></div><div id="footer"><div class="footerLine"></div>
          © Microsoft Corporation. All rights reserved.  Send <a href="mailto:DevDocs@microsoft.com?subject=Documentation Feedback :MantaWeb Sample: Online Personal Information Management">comments</a> about this topic to Microsoft.
      </div></div></body></html>
